<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Vookoo: include/vku/vku_framework.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Vookoo
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_995fe1d227c607390ad9698aa181d942.html">vku</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">vku_framework.hpp</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Demo framework for the Vookoo for the Vookoo high level C++ Vulkan interface.</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// (C) Andy Thomason 2017 MIT License</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// This is an optional demo framework for the Vookoo high level C++ Vulkan interface.</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#ifndef VKU_FRAMEWORK_HPP</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#define VKU_FRAMEWORK_HPP</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#ifdef _WIN32</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#define VK_USE_PLATFORM_WIN32_KHR</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#define GLFW_EXPOSE_NATIVE_WIN32</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#define VKU_SURFACE &quot;VK_KHR_win32_surface&quot;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#pragma warning(disable : 4005)</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#define VK_USE_PLATFORM_XLIB_KHR</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#define GLFW_EXPOSE_NATIVE_X11</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#define VKU_SURFACE &quot;VK_KHR_xlib_surface&quot;</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#ifndef VKU_NO_GLFW</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#define GLFW_INCLUDE_VULKAN</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &lt;GLFW/glfw3.h&gt;</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &lt;GLFW/glfw3native.h&gt;</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">// Undo damage done by windows.h</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#undef APIENTRY</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#undef None</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#undef max</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#undef min</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &lt;array&gt;</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &lt;fstream&gt;</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &lt;unordered_map&gt;</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &lt;vector&gt;</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="preprocessor">#include &lt;thread&gt;</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="preprocessor">#include &lt;chrono&gt;</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="preprocessor">#include &lt;functional&gt;</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="preprocessor">#include &lt;cstddef&gt;</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="preprocessor">#include &lt;vulkan/vulkan.hpp&gt;</span></div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="preprocessor">#include &lt;vku/vku.hpp&gt;</span></div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacevku.html">vku</a> {</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno"><a class="line" href="classvku_1_1_framework.html">   56</a></span>&#160;<span class="keyword">class </span><a class="code" href="classvku_1_1_framework.html">Framework</a> {</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <a class="code" href="classvku_1_1_framework.html">Framework</a>() {</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  }</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <span class="comment">// Construct a framework containing the instance, a device and one or more queues.</span></div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <a class="code" href="classvku_1_1_framework.html">Framework</a>(<span class="keyword">const</span> std::string &amp;name) {</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    std::vector&lt;const char *&gt; layers;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    layers.push_back(<span class="stringliteral">&quot;VK_LAYER_LUNARG_standard_validation&quot;</span>);</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    std::vector&lt;const char *&gt; instance_extensions;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    instance_extensions.push_back(VK_EXT_DEBUG_REPORT_EXTENSION_NAME);</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    instance_extensions.push_back(VKU_SURFACE);</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    instance_extensions.push_back(<span class="stringliteral">&quot;VK_KHR_surface&quot;</span>);</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keyword">auto</span> appinfo = vk::ApplicationInfo{};</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    instance_ = vk::createInstanceUnique(vk::InstanceCreateInfo{</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        {}, &amp;appinfo, (uint32_t)layers.size(),</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        layers.data(), (uint32_t)instance_extensions.size(),</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        instance_extensions.data()});</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keyword">auto</span> ci = vk::DebugReportCallbackCreateInfoEXT{</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <span class="comment">//vk::DebugReportFlagBitsEXT::eInformation |</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        vk::DebugReportFlagBitsEXT::eWarning |</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        vk::DebugReportFlagBitsEXT::ePerformanceWarning |</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        vk::DebugReportFlagBitsEXT::eError,</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="comment">//vk::DebugReportFlagBitsEXT::eDebug,</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        &amp;debugCallback};</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keyword">const</span> VkDebugReportCallbackCreateInfoEXT &amp;cir = ci;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="keyword">auto</span> vkCreateDebugReportCallbackEXT =</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        (PFN_vkCreateDebugReportCallbackEXT)instance_-&gt;getProcAddr(</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;            <span class="stringliteral">&quot;vkCreateDebugReportCallbackEXT&quot;</span>);</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    VkDebugReportCallbackEXT cb;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    vkCreateDebugReportCallbackEXT(</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        *instance_, &amp;(<span class="keyword">const</span> VkDebugReportCallbackCreateInfoEXT &amp;)ci,</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        <span class="keyword">nullptr</span>, &amp;cb);</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    callback_ = cb;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keyword">auto</span> pds = instance_-&gt;enumeratePhysicalDevices();</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    physical_device_ = pds[0];</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keyword">auto</span> qprops = physical_device_.getQueueFamilyProperties();</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> badQueue = ~(uint32_t)0;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    graphicsQueueFamilyIndex_ = badQueue;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    computeQueueFamilyIndex_ = badQueue;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    vk::QueueFlags search = vk::QueueFlagBits::eGraphics|vk::QueueFlagBits::eCompute;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="comment">// Look for an omnipurpose queue family first</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="comment">// It is better if we can schedule operations without barriers and semaphores.</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <span class="comment">// The Spec says: &quot;If an implementation exposes any queue family that supports graphics operations,</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="comment">// at least one queue family of at least one physical device exposed by the implementation</span></div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="comment">// must support both graphics and compute operations.&quot;</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="comment">// Also: All commands that are allowed on a queue that supports transfer operations are</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="comment">// also allowed on a queue that supports either graphics or compute operations...</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="comment">// As a result we can expect a queue family with at least all three and maybe all four modes.</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keywordflow">for</span> (uint32_t qi = 0; qi != qprops.size(); ++qi) {</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      <span class="keyword">auto</span> &amp;qprop = qprops[qi];</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      <span class="comment">//std::cout &lt;&lt; vk::to_string(qprop.queueFlags) &lt;&lt; &quot;\n&quot;;</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      <span class="keywordflow">if</span> ((qprop.queueFlags &amp; search) == search) {</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        graphicsQueueFamilyIndex_ = qi;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        computeQueueFamilyIndex_ = qi;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      }</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    }</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keywordflow">if</span> (graphicsQueueFamilyIndex_ == badQueue || computeQueueFamilyIndex_ == badQueue) {</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;oops, missing a queue\n&quot;</span>;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    }</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    memprops_ = physical_device_.getMemoryProperties();</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="comment">// todo: find optimal texture format</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="comment">// auto rgbaprops = physical_device_.getFormatProperties(vk::Format::eR8G8B8A8Unorm);</span></div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    std::vector&lt;const char *&gt; device_extensions;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    device_extensions.push_back(VK_KHR_SWAPCHAIN_EXTENSION_NAME);</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="keywordtype">float</span> queue_priorities[] = {0.0f};</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    std::vector&lt;vk::DeviceQueueCreateInfo&gt; qci;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    qci.emplace_back(vk::DeviceQueueCreateFlags{}, graphicsQueueFamilyIndex_, 1,</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                     queue_priorities);</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="keywordflow">if</span> (computeQueueFamilyIndex_ != graphicsQueueFamilyIndex_) {</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      qci.emplace_back(vk::DeviceQueueCreateFlags{}, computeQueueFamilyIndex_, 1,</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                       queue_priorities);</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    };</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <span class="keywordtype">float</span> graphicsQueue_priorities[] = {0.0f};</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    device_ = physical_device_.createDeviceUnique(vk::DeviceCreateInfo{</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        {}, (uint32_t)qci.size(), qci.data(),</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        (uint32_t)layers.size(), layers.data(),</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        (uint32_t)device_extensions.size(), device_extensions.data()});</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <span class="comment">//vk::Queue graphicsQueue_ = device_-&gt;getQueue(graphicsQueueFamilyIndex_, 0);</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="comment">//vk::Queue computeQueue_ = device_-&gt;getQueue(computeQueueFamilyIndex_, 0);</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    vk::PipelineCacheCreateInfo pipelineCacheInfo{};</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    pipelineCache_ = device_-&gt;createPipelineCacheUnique(pipelineCacheInfo);</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    std::vector&lt;vk::DescriptorPoolSize&gt; poolSizes;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    poolSizes.emplace_back(vk::DescriptorType::eUniformBuffer, 128);</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    poolSizes.emplace_back(vk::DescriptorType::eCombinedImageSampler, 128);</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    poolSizes.emplace_back(vk::DescriptorType::eStorageBuffer, 128);</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <span class="comment">// Create an arbitrary number of descriptors in a pool.</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="comment">// Allow the descriptors to be freed, possibly not optimal behaviour.</span></div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    vk::DescriptorPoolCreateInfo descriptorPoolInfo{};</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    descriptorPoolInfo.flags = vk::DescriptorPoolCreateFlagBits::eFreeDescriptorSet;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    descriptorPoolInfo.maxSets = 256;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    descriptorPoolInfo.poolSizeCount = (uint32_t)poolSizes.size();</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    descriptorPoolInfo.pPoolSizes = poolSizes.data();</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    descriptorPool_ = device_-&gt;createDescriptorPoolUnique(descriptorPoolInfo);</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    ok_ = <span class="keyword">true</span>;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  }</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="keywordtype">void</span> dumpCaps(std::ostream &amp;os)<span class="keyword"> const </span>{</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;Memory Types\n&quot;</span>;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordflow">for</span> (uint32_t i = 0; i != memprops_.memoryTypeCount; ++i) {</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;  type&quot;</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot; heap&quot;</span> &lt;&lt; memprops_.memoryTypes[i].heapIndex &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; vk::to_string(memprops_.memoryTypes[i].propertyFlags) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    }</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;Heaps\n&quot;</span>;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keywordflow">for</span> (uint32_t i = 0; i != memprops_.memoryHeapCount; ++i) {</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;  heap&quot;</span> &lt;&lt; vk::to_string(memprops_.memoryHeaps[i].flags) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; memprops_.memoryHeaps[i].size &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    }</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  }</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div><div class="line"><a name="l00187"></a><span class="lineno"><a class="line" href="classvku_1_1_framework.html#ab61c9f55d26e4ee6b5d699d50deeb0ad">  187</a></span>&#160;  <span class="keyword">const</span> vk::Instance <a class="code" href="classvku_1_1_framework.html#ab61c9f55d26e4ee6b5d699d50deeb0ad">instance</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> *instance_; }</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;</div><div class="line"><a name="l00190"></a><span class="lineno"><a class="line" href="classvku_1_1_framework.html#a39fa9cb694b8fe66d5f647635aaca77c">  190</a></span>&#160;  <span class="keyword">const</span> vk::Device <a class="code" href="classvku_1_1_framework.html#a39fa9cb694b8fe66d5f647635aaca77c">device</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> *device_; }</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div><div class="line"><a name="l00193"></a><span class="lineno"><a class="line" href="classvku_1_1_framework.html#a0dfef6c7f9b451393d6286d48ee4213e">  193</a></span>&#160;  <span class="keyword">const</span> vk::Queue <a class="code" href="classvku_1_1_framework.html#a0dfef6c7f9b451393d6286d48ee4213e">graphicsQueue</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> device_-&gt;getQueue(graphicsQueueFamilyIndex_, 0); }</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;</div><div class="line"><a name="l00196"></a><span class="lineno"><a class="line" href="classvku_1_1_framework.html#a600d9a2e7fc024b318ad9cbeaca13984">  196</a></span>&#160;  <span class="keyword">const</span> vk::Queue <a class="code" href="classvku_1_1_framework.html#a600d9a2e7fc024b318ad9cbeaca13984">computeQueue</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> device_-&gt;getQueue(computeQueueFamilyIndex_, 0); }</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno"><a class="line" href="classvku_1_1_framework.html#a0490d0fe0d8276ede4de6e557c24718b">  199</a></span>&#160;  <span class="keyword">const</span> vk::PhysicalDevice &amp;<a class="code" href="classvku_1_1_framework.html#a0490d0fe0d8276ede4de6e557c24718b">physicalDevice</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> physical_device_; }</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div><div class="line"><a name="l00202"></a><span class="lineno"><a class="line" href="classvku_1_1_framework.html#ad45b3d217f4ae39480b65d6558a962b7">  202</a></span>&#160;  <span class="keyword">const</span> vk::PipelineCache <a class="code" href="classvku_1_1_framework.html#ad45b3d217f4ae39480b65d6558a962b7">pipelineCache</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> *pipelineCache_; }</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;</div><div class="line"><a name="l00205"></a><span class="lineno"><a class="line" href="classvku_1_1_framework.html#adc1825bb6f9201a715e8d749feee3c39">  205</a></span>&#160;  <span class="keyword">const</span> vk::DescriptorPool <a class="code" href="classvku_1_1_framework.html#adc1825bb6f9201a715e8d749feee3c39">descriptorPool</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> *descriptorPool_; }</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;</div><div class="line"><a name="l00208"></a><span class="lineno"><a class="line" href="classvku_1_1_framework.html#a9a09279a046254b71d9575de369b585c">  208</a></span>&#160;  uint32_t <a class="code" href="classvku_1_1_framework.html#a9a09279a046254b71d9575de369b585c">graphicsQueueFamilyIndex</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> graphicsQueueFamilyIndex_; }</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno"><a class="line" href="classvku_1_1_framework.html#acfac5e49c8d7c89125ad0021e3308997">  211</a></span>&#160;  uint32_t <a class="code" href="classvku_1_1_framework.html#acfac5e49c8d7c89125ad0021e3308997">computeQueueFamilyIndex</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> computeQueueFamilyIndex_; }</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <span class="keyword">const</span> vk::PhysicalDeviceMemoryProperties &amp;memprops()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> memprops_; }</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;</div><div class="line"><a name="l00216"></a><span class="lineno"><a class="line" href="classvku_1_1_framework.html#a4690bf772209a235299a896896f36a59">  216</a></span>&#160;  <a class="code" href="classvku_1_1_framework.html#a4690bf772209a235299a896896f36a59">~Framework</a>() {</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="keywordflow">if</span> (device_) {</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      device_-&gt;waitIdle();</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      <span class="keywordflow">if</span> (pipelineCache_) {</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        pipelineCache_.reset();</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      }</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      <span class="keywordflow">if</span> (descriptorPool_) {</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        descriptorPool_.reset();</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      }</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      device_.reset();</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    }</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="keywordflow">if</span> (instance_) {</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      <span class="keyword">auto</span> vkDestroyDebugReportCallbackEXT =</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;          (PFN_vkDestroyDebugReportCallbackEXT)instance_-&gt;getProcAddr(</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;              <span class="stringliteral">&quot;vkDestroyDebugReportCallbackEXT&quot;</span>);</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      vkDestroyDebugReportCallbackEXT(*instance_, callback_, <span class="keyword">nullptr</span>);</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      instance_.reset();</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    }</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;  }</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <a class="code" href="classvku_1_1_framework.html">Framework</a> &amp;operator=(<a class="code" href="classvku_1_1_framework.html">Framework</a> &amp;&amp;rhs) = <span class="keywordflow">default</span>;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;</div><div class="line"><a name="l00240"></a><span class="lineno"><a class="line" href="classvku_1_1_framework.html#a40135064e21a5c6d38c209c3194a152d">  240</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classvku_1_1_framework.html#a40135064e21a5c6d38c209c3194a152d">ok</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> ok_; }</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  <span class="comment">// Report any errors or warnings.</span></div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  <span class="keyword">static</span> VKAPI_ATTR VkBool32 VKAPI_CALL debugCallback(</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      VkDebugReportFlagsEXT flags, VkDebugReportObjectTypeEXT objectType,</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      uint64_t <span class="keywordtype">object</span>, <span class="keywordtype">size_t</span> location, int32_t messageCode,</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">char</span> *pLayerPrefix, <span class="keyword">const</span> <span class="keywordtype">char</span> *pMessage, <span class="keywordtype">void</span> *pUserData) {</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    printf(<span class="stringliteral">&quot;%08x debugCallback: %s\n&quot;</span>, flags, pMessage);</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="keywordflow">return</span> VK_FALSE;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  }</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  vk::UniqueInstance instance_;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  vk::UniqueDevice device_;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  vk::DebugReportCallbackEXT callback_;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  vk::PhysicalDevice physical_device_;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  vk::UniquePipelineCache pipelineCache_;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  vk::UniqueDescriptorPool descriptorPool_;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  uint32_t graphicsQueueFamilyIndex_;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  uint32_t computeQueueFamilyIndex_;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  vk::PhysicalDeviceMemoryProperties memprops_;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <span class="keywordtype">bool</span> ok_ = <span class="keyword">false</span>;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;};</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div><div class="line"><a name="l00265"></a><span class="lineno"><a class="line" href="classvku_1_1_window.html">  265</a></span>&#160;<span class="keyword">class </span><a class="code" href="classvku_1_1_window.html">Window</a> {</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <a class="code" href="classvku_1_1_window.html">Window</a>() {</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  }</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="preprocessor">#ifndef VKU_NO_GLFW</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <a class="code" href="classvku_1_1_window.html">Window</a>(<span class="keyword">const</span> vk::Instance &amp;<a class="code" href="classvku_1_1_framework.html#ab61c9f55d26e4ee6b5d699d50deeb0ad">instance</a>, <span class="keyword">const</span> vk::Device &amp;<a class="code" href="classvku_1_1_framework.html#a39fa9cb694b8fe66d5f647635aaca77c">device</a>, <span class="keyword">const</span> vk::PhysicalDevice &amp;<a class="code" href="classvku_1_1_framework.html#a0490d0fe0d8276ede4de6e557c24718b">physicalDevice</a>, uint32_t <a class="code" href="classvku_1_1_framework.html#a9a09279a046254b71d9575de369b585c">graphicsQueueFamilyIndex</a>, GLFWwindow *window) {</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="preprocessor">#ifdef VK_USE_PLATFORM_WIN32_KHR</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="keyword">auto</span> module = GetModuleHandle(<span class="keyword">nullptr</span>);</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="keyword">auto</span> handle = glfwGetWin32Window(window);</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="keyword">auto</span> ci = vk::Win32SurfaceCreateInfoKHR{{}, module, handle};</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="keyword">auto</span> surface = instance.createWin32SurfaceKHR(ci);</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="preprocessor">#ifdef VK_USE_PLATFORM_XLIB_KHR</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="keyword">auto</span> display = glfwGetX11Display();</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <span class="keyword">auto</span> x11window = glfwGetX11Window(window);</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="keyword">auto</span> ci = vk::XlibSurfaceCreateInfoKHR{{}, display, x11window};</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="keyword">auto</span> surface = instance.createXlibSurfaceKHR(ci);</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    init(instance, device, physicalDevice, graphicsQueueFamilyIndex, surface);</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  }</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  <a class="code" href="classvku_1_1_window.html">Window</a>(<span class="keyword">const</span> vk::Instance &amp;instance, <span class="keyword">const</span> vk::Device &amp;device, <span class="keyword">const</span> vk::PhysicalDevice &amp;physicalDevice, uint32_t graphicsQueueFamilyIndex, vk::SurfaceKHR surface) {</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    init(instance, device, physicalDevice, graphicsQueueFamilyIndex, surface);</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  }</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <span class="keywordtype">void</span> init(<span class="keyword">const</span> vk::Instance &amp;instance, <span class="keyword">const</span> vk::Device &amp;device, <span class="keyword">const</span> vk::PhysicalDevice &amp;physicalDevice, uint32_t graphicsQueueFamilyIndex, vk::SurfaceKHR surface) {</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="comment">//surface_ = vk::UniqueSurfaceKHR(surface);</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="comment">//surface_ = vk::UniqueSurfaceKHR(surface, vk::SurfaceKHRDeleter{ instance });</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    surface_ = surface;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    instance_ = <a class="code" href="classvku_1_1_framework.html#ab61c9f55d26e4ee6b5d699d50deeb0ad">instance</a>;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    device_ = <a class="code" href="classvku_1_1_framework.html#a39fa9cb694b8fe66d5f647635aaca77c">device</a>;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    presentQueueFamily_ = 0;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <span class="keyword">auto</span> &amp;pd = <a class="code" href="classvku_1_1_framework.html#a0490d0fe0d8276ede4de6e557c24718b">physicalDevice</a>;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="keyword">auto</span> qprops = pd.getQueueFamilyProperties();</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keywordtype">bool</span> found = <span class="keyword">false</span>;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keywordflow">for</span> (uint32_t qi = 0; qi != qprops.size(); ++qi) {</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      <span class="keywordflow">if</span> (pd.getSurfaceSupportKHR(qi, surface_)) {</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;        presentQueueFamily_ = qi;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        found = <span class="keyword">true</span>;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      }</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    }</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="keywordflow">if</span> (!found) {</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;No Vulkan present queues found\n&quot;</span>;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    }</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="keyword">auto</span> fmts = pd.getSurfaceFormatsKHR(surface_);</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    swapchainImageFormat_ = fmts[0].format;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    swapchainColorSpace_ = fmts[0].colorSpace;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="keywordflow">if</span> (fmts.size() == 1 &amp;&amp; swapchainImageFormat_ == vk::Format::eUndefined) {</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      swapchainImageFormat_ = vk::Format::eB8G8R8A8Unorm;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;      swapchainColorSpace_ = vk::ColorSpaceKHR::eSrgbNonlinear;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;fmt : fmts) {</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        <span class="keywordflow">if</span> (fmt.format == vk::Format::eB8G8R8A8Unorm) {</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;          swapchainImageFormat_ = fmt.format;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;          swapchainColorSpace_ = fmt.colorSpace;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        }</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      }</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    }</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keyword">auto</span> surfaceCaps = pd.getSurfaceCapabilitiesKHR(surface_);</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    width_ = surfaceCaps.currentExtent.width;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    height_ = surfaceCaps.currentExtent.height;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keyword">auto</span> pms = pd.getSurfacePresentModesKHR(surface_);</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    vk::PresentModeKHR presentMode = pms[0];</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keywordflow">if</span> (std::find(pms.begin(), pms.end(), vk::PresentModeKHR::eFifo) != pms.end()) {</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      presentMode = vk::PresentModeKHR::eFifo;</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;      std::cout &lt;&lt; <span class="stringliteral">&quot;No fifo mode available\n&quot;</span>;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    }</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="comment">//std::cout &lt;&lt; &quot;using &quot; &lt;&lt; vk::to_string(presentMode) &lt;&lt; &quot;\n&quot;;</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    vk::SwapchainCreateInfoKHR swapinfo{};</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    std::array&lt;uint32_t, 2&gt; queueFamilyIndices = { <a class="code" href="classvku_1_1_framework.html#a9a09279a046254b71d9575de369b585c">graphicsQueueFamilyIndex</a>, presentQueueFamily_ };</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="keywordtype">bool</span> sameQueues = queueFamilyIndices[0] == queueFamilyIndices[1];</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    vk::SharingMode sharingMode = !sameQueues ? vk::SharingMode::eConcurrent : vk::SharingMode::eExclusive;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    swapinfo.imageExtent = surfaceCaps.currentExtent;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    swapinfo.surface = surface_;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    swapinfo.minImageCount = surfaceCaps.minImageCount + 1;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    swapinfo.imageFormat = swapchainImageFormat_;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    swapinfo.imageColorSpace = swapchainColorSpace_;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    swapinfo.imageExtent = surfaceCaps.currentExtent;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    swapinfo.imageArrayLayers = 1;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    swapinfo.imageUsage = vk::ImageUsageFlagBits::eColorAttachment;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    swapinfo.imageSharingMode = sharingMode;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    swapinfo.queueFamilyIndexCount = !sameQueues ? 2 : 0;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    swapinfo.pQueueFamilyIndices = queueFamilyIndices.data();</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    swapinfo.preTransform = surfaceCaps.currentTransform;;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    swapinfo.compositeAlpha = vk::CompositeAlphaFlagBitsKHR::eOpaque;</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    swapinfo.presentMode = presentMode;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    swapinfo.clipped = 1;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    swapinfo.oldSwapchain = vk::SwapchainKHR{};</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    swapchain_ = device.createSwapchainKHRUnique(swapinfo);</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    images_ = device.getSwapchainImagesKHR(*swapchain_);</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;img : images_) {</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;      vk::ImageViewCreateInfo ci{};</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      ci.image = img;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;      ci.viewType = vk::ImageViewType::e2D;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;      ci.format = swapchainImageFormat_;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;      ci.subresourceRange = {vk::ImageAspectFlagBits::eColor, 0, 1, 0, 1};</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      imageViews_.emplace_back(device.createImageView(ci));</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    }</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="keyword">auto</span> memprops = physicalDevice.getMemoryProperties();</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    depthStencilImage_ = <a class="code" href="classvku_1_1_depth_stencil_image.html">vku::DepthStencilImage</a>(device, memprops, width_, height_);</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="comment">// Build the renderpass using two attachments, colour and depth/stencil.</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <a class="code" href="classvku_1_1_renderpass_maker.html">vku::RenderpassMaker</a> rpm;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="comment">// The only colour attachment.</span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    rpm.<a class="code" href="classvku_1_1_renderpass_maker.html#a95f7a27a27e148a2e8c52c9f743bed27">attachmentBegin</a>(swapchainImageFormat_);</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    rpm.attachmentLoadOp(vk::AttachmentLoadOp::eClear);</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    rpm.attachmentStoreOp(vk::AttachmentStoreOp::eStore);</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    rpm.attachmentFinalLayout(vk::ImageLayout::ePresentSrcKHR);</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="comment">// The depth/stencil attachment.</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    rpm.<a class="code" href="classvku_1_1_renderpass_maker.html#a95f7a27a27e148a2e8c52c9f743bed27">attachmentBegin</a>(depthStencilImage_.format());</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    rpm.attachmentLoadOp(vk::AttachmentLoadOp::eClear);</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    rpm.attachmentStencilLoadOp(vk::AttachmentLoadOp::eDontCare);</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    rpm.attachmentFinalLayout(vk::ImageLayout::eDepthStencilAttachmentOptimal);</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="comment">// A subpass to render using the above two attachments.</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    rpm.<a class="code" href="classvku_1_1_renderpass_maker.html#a8e07675f812d1309a1767151b649e63d">subpassBegin</a>(vk::PipelineBindPoint::eGraphics);</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    rpm.subpassColorAttachment(vk::ImageLayout::eColorAttachmentOptimal, 0);</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    rpm.subpassDepthStencilAttachment(vk::ImageLayout::eDepthStencilAttachmentOptimal, 1);</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="comment">// A dependency to reset the layout of both attachments.</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    rpm.dependencyBegin(VK_SUBPASS_EXTERNAL, 0);</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    rpm.dependencySrcStageMask(vk::PipelineStageFlagBits::eColorAttachmentOutput);</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    rpm.dependencyDstStageMask(vk::PipelineStageFlagBits::eColorAttachmentOutput);</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    rpm.dependencyDstAccessMask(vk::AccessFlagBits::eColorAttachmentRead|vk::AccessFlagBits::eColorAttachmentWrite);</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="comment">// Use the maker object to construct the vulkan object</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    renderPass_ = rpm.createUnique(device);</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i != imageViews_.size(); ++i) {</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      vk::ImageView attachments[2] = {imageViews_[i], depthStencilImage_.imageView()};</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      vk::FramebufferCreateInfo fbci{{}, *renderPass_, 2, attachments, width_, height_, 1 };</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;      framebuffers_.push_back(device.createFramebufferUnique(fbci));</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    }</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    vk::SemaphoreCreateInfo sci;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    imageAcquireSemaphore_ = device.createSemaphoreUnique(sci);</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    commandCompleteSemaphore_ = device.createSemaphoreUnique(sci);</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    dynamicSemaphore_ = device.createSemaphoreUnique(sci);</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="keyword">typedef</span> vk::CommandPoolCreateFlagBits ccbits;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    vk::CommandPoolCreateInfo cpci{ ccbits::eTransient|ccbits::eResetCommandBuffer, graphicsQueueFamilyIndex };</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    commandPool_ = device.createCommandPoolUnique(cpci);</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="comment">// Create static draw buffers</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    vk::CommandBufferAllocateInfo cbai{ *commandPool_, vk::CommandBufferLevel::ePrimary, (uint32_t)framebuffers_.size() };</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    staticDrawBuffers_ = device.allocateCommandBuffersUnique(cbai);</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    dynamicDrawBuffers_ = device.allocateCommandBuffersUnique(cbai);</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="comment">// Create a set of fences to protect the command buffers from re-writing.</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i != staticDrawBuffers_.size(); ++i) {</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      vk::FenceCreateInfo fci;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;      fci.flags = vk::FenceCreateFlagBits::eSignaled;</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      commandBufferFences_.emplace_back(device.createFence(fci));</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    }</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i != staticDrawBuffers_.size(); ++i) {</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;      vk::CommandBuffer cb = *staticDrawBuffers_[i];</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;      vk::CommandBufferBeginInfo bi{};</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;      cb.begin(bi);</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      cb.end();</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    }</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    ok_ = <span class="keyword">true</span>;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  }</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;</div><div class="line"><a name="l00449"></a><span class="lineno"><a class="line" href="classvku_1_1_window.html#a62280edb5e49822c97ee4e841d5bd67c">  449</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classvku_1_1_window.html#a62280edb5e49822c97ee4e841d5bd67c">dumpCaps</a>(std::ostream &amp;os, vk::PhysicalDevice pd)<span class="keyword"> const </span>{</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;Surface formats\n&quot;</span>;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="keyword">auto</span> fmts = pd.getSurfaceFormatsKHR(surface_);</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;fmt : fmts) {</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;      <span class="keyword">auto</span> fmtstr = vk::to_string(fmt.format);</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;      <span class="keyword">auto</span> cstr = vk::to_string(fmt.colorSpace);</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;      os &lt;&lt; <span class="stringliteral">&quot;format=&quot;</span> &lt;&lt; fmtstr &lt;&lt; <span class="stringliteral">&quot; colorSpace=&quot;</span> &lt;&lt; cstr &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    }</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    os &lt;&lt; <span class="stringliteral">&quot;Present Modes\n&quot;</span>;</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="keyword">auto</span> presentModes = pd.getSurfacePresentModesKHR(surface_);</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> pm : presentModes) {</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;      std::cout &lt;&lt; vk::to_string(pm) &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    }</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;  }</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;  <span class="keyword">static</span> <span class="keywordtype">void</span> defaultRenderFunc(vk::CommandBuffer cb, <span class="keywordtype">int</span> imageIndex, vk::RenderPassBeginInfo &amp;rpbi) {</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    vk::CommandBufferBeginInfo bi{};</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    cb.begin(bi);</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    cb.end();</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  }</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  <span class="keyword">typedef</span> void (renderFunc_t)(vk::CommandBuffer cb, <span class="keywordtype">int</span> imageIndex, vk::RenderPassBeginInfo &amp;rpbi);</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;</div><div class="line"><a name="l00474"></a><span class="lineno"><a class="line" href="classvku_1_1_window.html#af7d7efcd33752450be9d09fd3407c7a9">  474</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classvku_1_1_window.html#af7d7efcd33752450be9d09fd3407c7a9">setStaticCommands</a>(<span class="keyword">const</span> std::function&lt;renderFunc_t&gt; &amp;func) {</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i != staticDrawBuffers_.size(); ++i) {</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;      vk::CommandBuffer cb = *staticDrawBuffers_[i];</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;      std::array&lt;float, 4&gt; clearColorValue{0.75f, 0.75f, 0.75f, 1};</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;      vk::ClearDepthStencilValue clearDepthValue{ 1.0f, 0 };</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;      std::array&lt;vk::ClearValue, 2&gt; clearColours{vk::ClearValue{clearColorValue}, clearDepthValue};</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;      vk::RenderPassBeginInfo rpbi;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      rpbi.renderPass = *renderPass_;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      rpbi.framebuffer = *framebuffers_[i];</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;      rpbi.renderArea = vk::Rect2D{{0, 0}, {width_, height_}};</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;      rpbi.clearValueCount = (uint32_t)clearColours.size();</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;      rpbi.pClearValues = clearColours.data();</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;      func(cb, i, rpbi); </div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    }</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  }</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;</div><div class="line"><a name="l00494"></a><span class="lineno"><a class="line" href="classvku_1_1_window.html#a74ee0b88b51ee7b749a5f6efb597bc53">  494</a></span>&#160;  <span class="keywordtype">void</span> <a class="code" href="classvku_1_1_window.html#a74ee0b88b51ee7b749a5f6efb597bc53">draw</a>(<span class="keyword">const</span> vk::Device &amp;device, <span class="keyword">const</span> vk::Queue &amp;<a class="code" href="classvku_1_1_framework.html#a0dfef6c7f9b451393d6286d48ee4213e">graphicsQueue</a>, <span class="keyword">const</span> std::function&lt;<span class="keywordtype">void</span> (vk::CommandBuffer cb, <span class="keywordtype">int</span> imageIndex, vk::RenderPassBeginInfo &amp;rpbi)&gt; &amp;dynamic = defaultRenderFunc) {</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="keyword">static</span> <span class="keyword">auto</span> start = std::chrono::high_resolution_clock::now();</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <span class="keyword">auto</span> time = std::chrono::high_resolution_clock::now();</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="keyword">auto</span> delta = time - start;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    start = time;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="comment">// uncomment to get frame time.</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="comment">//std::cout &lt;&lt; std::chrono::duration_cast&lt;std::chrono::microseconds&gt;(delta).count() &lt;&lt; &quot;us frame time\n&quot;;</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="keyword">auto</span> umax = std::numeric_limits&lt;uint64_t&gt;::max();</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    uint32_t imageIndex = 0;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    device.acquireNextImageKHR(*swapchain_, umax, *imageAcquireSemaphore_, vk::Fence(), &amp;imageIndex);</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    vk::PipelineStageFlags waitStages = vk::PipelineStageFlagBits::eColorAttachmentOutput;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    vk::Semaphore ccSema = *commandCompleteSemaphore_;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    vk::Semaphore iaSema = *imageAcquireSemaphore_;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    vk::Semaphore psSema = *dynamicSemaphore_;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    vk::CommandBuffer cb = *staticDrawBuffers_[imageIndex];</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    vk::CommandBuffer pscb = *dynamicDrawBuffers_[imageIndex];</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    vk::Fence cbFence = commandBufferFences_[imageIndex];</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    device.waitForFences(cbFence, 1, umax);</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    device.resetFences(cbFence);</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    std::array&lt;float, 4&gt; clearColorValue{0.75f, 0.75f, 0.75f, 1};</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    vk::ClearDepthStencilValue clearDepthValue{ 1.0f, 0 };</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    std::array&lt;vk::ClearValue, 2&gt; clearColours{vk::ClearValue{clearColorValue}, clearDepthValue};</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    vk::RenderPassBeginInfo rpbi;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    rpbi.renderPass = *renderPass_;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    rpbi.framebuffer = *framebuffers_[imageIndex];</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    rpbi.renderArea = vk::Rect2D{{0, 0}, {width_, height_}};</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    rpbi.clearValueCount = (uint32_t)clearColours.size();</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    rpbi.pClearValues = clearColours.data();</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    dynamic(pscb, imageIndex, rpbi);</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    vk::SubmitInfo submit;</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    submit.waitSemaphoreCount = 1;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    submit.pWaitSemaphores = &amp;iaSema;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    submit.pWaitDstStageMask = &amp;waitStages;</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    submit.commandBufferCount = 1;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    submit.pCommandBuffers = &amp;pscb;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    submit.signalSemaphoreCount = 1;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    submit.pSignalSemaphores = &amp;psSema;</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    graphicsQueue.submit(1, &amp;submit, vk::Fence{});</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    submit.waitSemaphoreCount = 1;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    submit.pWaitSemaphores = &amp;psSema;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    submit.pWaitDstStageMask = &amp;waitStages;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    submit.commandBufferCount = 1;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    submit.pCommandBuffers = &amp;cb;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    submit.signalSemaphoreCount = 1;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    submit.pSignalSemaphores = &amp;ccSema;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    graphicsQueue.submit(1, &amp;submit, cbFence);</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    vk::PresentInfoKHR presentInfo;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    vk::SwapchainKHR swapchain = *swapchain_;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    presentInfo.pSwapchains = &amp;swapchain;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    presentInfo.swapchainCount = 1;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    presentInfo.pImageIndices = &amp;imageIndex;</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    presentInfo.waitSemaphoreCount = 1;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    presentInfo.pWaitSemaphores = &amp;ccSema;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    presentQueue().presentKHR(presentInfo);</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  }</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;</div><div class="line"><a name="l00558"></a><span class="lineno"><a class="line" href="classvku_1_1_window.html#a38e18f5134cee0a1aec52d4e05ba01cb">  558</a></span>&#160;  uint32_t <a class="code" href="classvku_1_1_window.html#a38e18f5134cee0a1aec52d4e05ba01cb">presentQueueFamily</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> presentQueueFamily_; }</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;</div><div class="line"><a name="l00561"></a><span class="lineno"><a class="line" href="classvku_1_1_window.html#af965a82c0d4db0cd2ec6d69b1aa6295a">  561</a></span>&#160;  <span class="keyword">const</span> vk::Queue <a class="code" href="classvku_1_1_window.html#af965a82c0d4db0cd2ec6d69b1aa6295a">presentQueue</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> device_.getQueue(presentQueueFamily_, 0); }</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;</div><div class="line"><a name="l00564"></a><span class="lineno"><a class="line" href="classvku_1_1_window.html#ab316980670759352a77bcfea54f2018f">  564</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="classvku_1_1_window.html#ab316980670759352a77bcfea54f2018f">ok</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> ok_; }</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;</div><div class="line"><a name="l00567"></a><span class="lineno"><a class="line" href="classvku_1_1_window.html#a1de0612826ca9e7c95976b21ba97cfbc">  567</a></span>&#160;  vk::RenderPass <a class="code" href="classvku_1_1_window.html#a1de0612826ca9e7c95976b21ba97cfbc">renderPass</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> *renderPass_; }</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;</div><div class="line"><a name="l00570"></a><span class="lineno"><a class="line" href="classvku_1_1_window.html#ae5b21152f302ef2079f9dd600039a157">  570</a></span>&#160;  <span class="keyword">const</span> std::vector&lt;vk::UniqueFramebuffer&gt; &amp;<a class="code" href="classvku_1_1_window.html#ae5b21152f302ef2079f9dd600039a157">framebuffers</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> framebuffers_; }</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;</div><div class="line"><a name="l00573"></a><span class="lineno"><a class="line" href="classvku_1_1_window.html#a7e577aa4b8d71daf4aecf3262ebb2248">  573</a></span>&#160;  <a class="code" href="classvku_1_1_window.html#a7e577aa4b8d71daf4aecf3262ebb2248">~Window</a>() {</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;iv : imageViews_) {</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;      device_.destroyImageView(iv);</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    }</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;f : commandBufferFences_) {</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;      device_.destroyFence(f);</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    }</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    swapchain_ = vk::UniqueSwapchainKHR{};</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  }</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;  <a class="code" href="classvku_1_1_window.html">Window</a> &amp;operator=(<a class="code" href="classvku_1_1_window.html">Window</a> &amp;&amp;rhs) = <span class="keywordflow">default</span>;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;</div><div class="line"><a name="l00586"></a><span class="lineno"><a class="line" href="classvku_1_1_window.html#a313d031caea0a2ebd0c7ba3d28fc0a72">  586</a></span>&#160;  uint32_t <a class="code" href="classvku_1_1_window.html#a313d031caea0a2ebd0c7ba3d28fc0a72">width</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> width_; }</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;</div><div class="line"><a name="l00589"></a><span class="lineno"><a class="line" href="classvku_1_1_window.html#a863f047752ac4e0710f004b9c6d0b7b0">  589</a></span>&#160;  uint32_t <a class="code" href="classvku_1_1_window.html#a863f047752ac4e0710f004b9c6d0b7b0">height</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> height_; }</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;</div><div class="line"><a name="l00592"></a><span class="lineno"><a class="line" href="classvku_1_1_window.html#ae522a36f60949617761371d494ce766f">  592</a></span>&#160;  vk::Format <a class="code" href="classvku_1_1_window.html#ae522a36f60949617761371d494ce766f">swapchainImageFormat</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> swapchainImageFormat_; }</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;</div><div class="line"><a name="l00595"></a><span class="lineno"><a class="line" href="classvku_1_1_window.html#a85d893d708d1df8d4ff4dae1e0870e64">  595</a></span>&#160;  vk::ColorSpaceKHR <a class="code" href="classvku_1_1_window.html#a85d893d708d1df8d4ff4dae1e0870e64">swapchainColorSpace</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> swapchainColorSpace_; }</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;</div><div class="line"><a name="l00598"></a><span class="lineno"><a class="line" href="classvku_1_1_window.html#a7ced8a7cf030e3f30c8313a68a3d23d8">  598</a></span>&#160;  <span class="keyword">const</span> vk::SwapchainKHR <a class="code" href="classvku_1_1_window.html#a7ced8a7cf030e3f30c8313a68a3d23d8">swapchain</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> *swapchain_; }</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;</div><div class="line"><a name="l00601"></a><span class="lineno"><a class="line" href="classvku_1_1_window.html#a50eeab1453c2c5e985f2df1f62de6565">  601</a></span>&#160;  <span class="keyword">const</span> std::vector&lt;vk::ImageView&gt; &amp;<a class="code" href="classvku_1_1_window.html#a50eeab1453c2c5e985f2df1f62de6565">imageViews</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> imageViews_; }</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;</div><div class="line"><a name="l00604"></a><span class="lineno"><a class="line" href="classvku_1_1_window.html#a65c379ad182e74d44db997e2be55f9fb">  604</a></span>&#160;  <span class="keyword">const</span> std::vector&lt;vk::Image&gt; &amp;<a class="code" href="classvku_1_1_window.html#a65c379ad182e74d44db997e2be55f9fb">images</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> images_; }</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;</div><div class="line"><a name="l00607"></a><span class="lineno"><a class="line" href="classvku_1_1_window.html#a7ee3e524fe6e3c0f7a7459b522368586">  607</a></span>&#160;  <span class="keyword">const</span> std::vector&lt;vk::UniqueCommandBuffer&gt; &amp;<a class="code" href="classvku_1_1_window.html#a7ee3e524fe6e3c0f7a7459b522368586">commandBuffers</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> staticDrawBuffers_; }</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;</div><div class="line"><a name="l00610"></a><span class="lineno"><a class="line" href="classvku_1_1_window.html#a918e978d75d5cc6a1409a8f8e60d2735">  610</a></span>&#160;  <span class="keyword">const</span> std::vector&lt;vk::Fence&gt; &amp;<a class="code" href="classvku_1_1_window.html#a918e978d75d5cc6a1409a8f8e60d2735">commandBufferFences</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> commandBufferFences_; }</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;</div><div class="line"><a name="l00613"></a><span class="lineno"><a class="line" href="classvku_1_1_window.html#a776998d6551da1e1b4462dfcc7437b85">  613</a></span>&#160;  vk::Semaphore <a class="code" href="classvku_1_1_window.html#a776998d6551da1e1b4462dfcc7437b85">imageAcquireSemaphore</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> *imageAcquireSemaphore_; }</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;</div><div class="line"><a name="l00616"></a><span class="lineno"><a class="line" href="classvku_1_1_window.html#a860291828c8e176979a0975358ee15ac">  616</a></span>&#160;  vk::Semaphore <a class="code" href="classvku_1_1_window.html#a860291828c8e176979a0975358ee15ac">commandCompleteSemaphore</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> *commandCompleteSemaphore_; }</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;</div><div class="line"><a name="l00619"></a><span class="lineno"><a class="line" href="classvku_1_1_window.html#a335f8cc62a55d17d970b1a910790e350">  619</a></span>&#160;  vk::CommandPool <a class="code" href="classvku_1_1_window.html#a335f8cc62a55d17d970b1a910790e350">commandPool</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> *commandPool_; }</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;</div><div class="line"><a name="l00622"></a><span class="lineno"><a class="line" href="classvku_1_1_window.html#ae72647dc506298b8aa36388b6eddd918">  622</a></span>&#160;  <span class="keywordtype">int</span> <a class="code" href="classvku_1_1_window.html#ae72647dc506298b8aa36388b6eddd918">numImageIndices</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> (<span class="keywordtype">int</span>)images_.size(); }</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  vk::Instance instance_;</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;  vk::SurfaceKHR surface_;</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;  vk::UniqueSwapchainKHR swapchain_;</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  vk::UniqueRenderPass renderPass_;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;  vk::UniqueSemaphore imageAcquireSemaphore_;</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;  vk::UniqueSemaphore commandCompleteSemaphore_;</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;  vk::UniqueSemaphore dynamicSemaphore_;</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  vk::UniqueCommandPool commandPool_;</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;  std::vector&lt;vk::ImageView&gt; imageViews_;</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;  std::vector&lt;vk::Image&gt; images_;</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  std::vector&lt;vk::Fence&gt; commandBufferFences_;</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;  std::vector&lt;vk::UniqueFramebuffer&gt; framebuffers_;</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;  std::vector&lt;vk::UniqueCommandBuffer&gt; staticDrawBuffers_;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;  std::vector&lt;vk::UniqueCommandBuffer&gt; dynamicDrawBuffers_;</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  <a class="code" href="classvku_1_1_depth_stencil_image.html">vku::DepthStencilImage</a> depthStencilImage_;</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;  uint32_t presentQueueFamily_ = 0;</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;  uint32_t width_;</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;  uint32_t height_;</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;  vk::Format swapchainImageFormat_ = vk::Format::eB8G8R8A8Unorm;</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;  vk::ColorSpaceKHR swapchainColorSpace_ = vk::ColorSpaceKHR::eSrgbNonlinear;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;  vk::Device device_;</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  <span class="keywordtype">bool</span> ok_;</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;};</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;} <span class="comment">// namespace vku</span></div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="preprocessor">#endif // VKU_FRAMEWORK_HPP</span></div><div class="ttc" id="classvku_1_1_window_html_af7d7efcd33752450be9d09fd3407c7a9"><div class="ttname"><a href="classvku_1_1_window.html#af7d7efcd33752450be9d09fd3407c7a9">vku::Window::setStaticCommands</a></div><div class="ttdeci">void setStaticCommands(const std::function&lt; renderFunc_t &gt; &amp;func)</div><div class="ttdoc">Build a static draw buffer. This will be rendered after any dynamic content generated in draw() ...</div><div class="ttdef"><b>Definition:</b> vku_framework.hpp:474</div></div>
<div class="ttc" id="classvku_1_1_framework_html_ad45b3d217f4ae39480b65d6558a962b7"><div class="ttname"><a href="classvku_1_1_framework.html#ad45b3d217f4ae39480b65d6558a962b7">vku::Framework::pipelineCache</a></div><div class="ttdeci">const vk::PipelineCache pipelineCache() const </div><div class="ttdoc">Get the default pipeline cache (you can use your own if you like). </div><div class="ttdef"><b>Definition:</b> vku_framework.hpp:202</div></div>
<div class="ttc" id="classvku_1_1_window_html"><div class="ttname"><a href="classvku_1_1_window.html">vku::Window</a></div><div class="ttdoc">This class wraps a window, a surface and a swap chain for that surface. </div><div class="ttdef"><b>Definition:</b> vku_framework.hpp:265</div></div>
<div class="ttc" id="classvku_1_1_window_html_a1de0612826ca9e7c95976b21ba97cfbc"><div class="ttname"><a href="classvku_1_1_window.html#a1de0612826ca9e7c95976b21ba97cfbc">vku::Window::renderPass</a></div><div class="ttdeci">vk::RenderPass renderPass() const </div><div class="ttdoc">Return the renderpass used by this window. </div><div class="ttdef"><b>Definition:</b> vku_framework.hpp:567</div></div>
<div class="ttc" id="classvku_1_1_window_html_a863f047752ac4e0710f004b9c6d0b7b0"><div class="ttname"><a href="classvku_1_1_window.html#a863f047752ac4e0710f004b9c6d0b7b0">vku::Window::height</a></div><div class="ttdeci">uint32_t height() const </div><div class="ttdoc">Return the height of the display. </div><div class="ttdef"><b>Definition:</b> vku_framework.hpp:589</div></div>
<div class="ttc" id="classvku_1_1_window_html_a65c379ad182e74d44db997e2be55f9fb"><div class="ttname"><a href="classvku_1_1_window.html#a65c379ad182e74d44db997e2be55f9fb">vku::Window::images</a></div><div class="ttdeci">const std::vector&lt; vk::Image &gt; &amp; images() const </div><div class="ttdoc">Return the swap chain images. </div><div class="ttdef"><b>Definition:</b> vku_framework.hpp:604</div></div>
<div class="ttc" id="classvku_1_1_window_html_a50eeab1453c2c5e985f2df1f62de6565"><div class="ttname"><a href="classvku_1_1_window.html#a50eeab1453c2c5e985f2df1f62de6565">vku::Window::imageViews</a></div><div class="ttdeci">const std::vector&lt; vk::ImageView &gt; &amp; imageViews() const </div><div class="ttdoc">Return the views of the swap chain images. </div><div class="ttdef"><b>Definition:</b> vku_framework.hpp:601</div></div>
<div class="ttc" id="classvku_1_1_framework_html_a0490d0fe0d8276ede4de6e557c24718b"><div class="ttname"><a href="classvku_1_1_framework.html#a0490d0fe0d8276ede4de6e557c24718b">vku::Framework::physicalDevice</a></div><div class="ttdeci">const vk::PhysicalDevice &amp; physicalDevice() const </div><div class="ttdoc">Get the physical device. </div><div class="ttdef"><b>Definition:</b> vku_framework.hpp:199</div></div>
<div class="ttc" id="classvku_1_1_framework_html_ab61c9f55d26e4ee6b5d699d50deeb0ad"><div class="ttname"><a href="classvku_1_1_framework.html#ab61c9f55d26e4ee6b5d699d50deeb0ad">vku::Framework::instance</a></div><div class="ttdeci">const vk::Instance instance() const </div><div class="ttdoc">Get the Vulkan instance. </div><div class="ttdef"><b>Definition:</b> vku_framework.hpp:187</div></div>
<div class="ttc" id="classvku_1_1_window_html_a85d893d708d1df8d4ff4dae1e0870e64"><div class="ttname"><a href="classvku_1_1_window.html#a85d893d708d1df8d4ff4dae1e0870e64">vku::Window::swapchainColorSpace</a></div><div class="ttdeci">vk::ColorSpaceKHR swapchainColorSpace() const </div><div class="ttdoc">Return the colour space of the back buffer (Usually sRGB) </div><div class="ttdef"><b>Definition:</b> vku_framework.hpp:595</div></div>
<div class="ttc" id="classvku_1_1_renderpass_maker_html_a8e07675f812d1309a1767151b649e63d"><div class="ttname"><a href="classvku_1_1_renderpass_maker.html#a8e07675f812d1309a1767151b649e63d">vku::RenderpassMaker::subpassBegin</a></div><div class="ttdeci">void subpassBegin(vk::PipelineBindPoint bp)</div><div class="ttdef"><b>Definition:</b> vku.hpp:334</div></div>
<div class="ttc" id="classvku_1_1_window_html_a7e577aa4b8d71daf4aecf3262ebb2248"><div class="ttname"><a href="classvku_1_1_window.html#a7e577aa4b8d71daf4aecf3262ebb2248">vku::Window::~Window</a></div><div class="ttdeci">~Window()</div><div class="ttdoc">Destroy resources when shutting down. </div><div class="ttdef"><b>Definition:</b> vku_framework.hpp:573</div></div>
<div class="ttc" id="classvku_1_1_framework_html_a600d9a2e7fc024b318ad9cbeaca13984"><div class="ttname"><a href="classvku_1_1_framework.html#a600d9a2e7fc024b318ad9cbeaca13984">vku::Framework::computeQueue</a></div><div class="ttdeci">const vk::Queue computeQueue() const </div><div class="ttdoc">Get the queue used to submit compute jobs. </div><div class="ttdef"><b>Definition:</b> vku_framework.hpp:196</div></div>
<div class="ttc" id="classvku_1_1_renderpass_maker_html"><div class="ttname"><a href="classvku_1_1_renderpass_maker.html">vku::RenderpassMaker</a></div><div class="ttdef"><b>Definition:</b> vku.hpp:309</div></div>
<div class="ttc" id="classvku_1_1_window_html_a313d031caea0a2ebd0c7ba3d28fc0a72"><div class="ttname"><a href="classvku_1_1_window.html#a313d031caea0a2ebd0c7ba3d28fc0a72">vku::Window::width</a></div><div class="ttdeci">uint32_t width() const </div><div class="ttdoc">Return the width of the display. </div><div class="ttdef"><b>Definition:</b> vku_framework.hpp:586</div></div>
<div class="ttc" id="classvku_1_1_framework_html_a0dfef6c7f9b451393d6286d48ee4213e"><div class="ttname"><a href="classvku_1_1_framework.html#a0dfef6c7f9b451393d6286d48ee4213e">vku::Framework::graphicsQueue</a></div><div class="ttdeci">const vk::Queue graphicsQueue() const </div><div class="ttdoc">Get the queue used to submit graphics jobs. </div><div class="ttdef"><b>Definition:</b> vku_framework.hpp:193</div></div>
<div class="ttc" id="classvku_1_1_window_html_a7ee3e524fe6e3c0f7a7459b522368586"><div class="ttname"><a href="classvku_1_1_window.html#a7ee3e524fe6e3c0f7a7459b522368586">vku::Window::commandBuffers</a></div><div class="ttdeci">const std::vector&lt; vk::UniqueCommandBuffer &gt; &amp; commandBuffers() const </div><div class="ttdoc">Return the static command buffers. </div><div class="ttdef"><b>Definition:</b> vku_framework.hpp:607</div></div>
<div class="ttc" id="classvku_1_1_framework_html_a40135064e21a5c6d38c209c3194a152d"><div class="ttname"><a href="classvku_1_1_framework.html#a40135064e21a5c6d38c209c3194a152d">vku::Framework::ok</a></div><div class="ttdeci">bool ok() const </div><div class="ttdoc">Returns true if the Framework has been built correctly. </div><div class="ttdef"><b>Definition:</b> vku_framework.hpp:240</div></div>
<div class="ttc" id="classvku_1_1_framework_html_acfac5e49c8d7c89125ad0021e3308997"><div class="ttname"><a href="classvku_1_1_framework.html#acfac5e49c8d7c89125ad0021e3308997">vku::Framework::computeQueueFamilyIndex</a></div><div class="ttdeci">uint32_t computeQueueFamilyIndex() const </div><div class="ttdoc">Get the family index for the compute queues. </div><div class="ttdef"><b>Definition:</b> vku_framework.hpp:211</div></div>
<div class="ttc" id="classvku_1_1_framework_html_adc1825bb6f9201a715e8d749feee3c39"><div class="ttname"><a href="classvku_1_1_framework.html#adc1825bb6f9201a715e8d749feee3c39">vku::Framework::descriptorPool</a></div><div class="ttdeci">const vk::DescriptorPool descriptorPool() const </div><div class="ttdoc">Get the default descriptor pool (you can use your own if you like). </div><div class="ttdef"><b>Definition:</b> vku_framework.hpp:205</div></div>
<div class="ttc" id="classvku_1_1_window_html_a62280edb5e49822c97ee4e841d5bd67c"><div class="ttname"><a href="classvku_1_1_window.html#a62280edb5e49822c97ee4e841d5bd67c">vku::Window::dumpCaps</a></div><div class="ttdeci">void dumpCaps(std::ostream &amp;os, vk::PhysicalDevice pd) const </div><div class="ttdoc">Dump the capabilities of the physical device used by this window. </div><div class="ttdef"><b>Definition:</b> vku_framework.hpp:449</div></div>
<div class="ttc" id="classvku_1_1_renderpass_maker_html_a95f7a27a27e148a2e8c52c9f743bed27"><div class="ttname"><a href="classvku_1_1_renderpass_maker.html#a95f7a27a27e148a2e8c52c9f743bed27">vku::RenderpassMaker::attachmentBegin</a></div><div class="ttdeci">void attachmentBegin(vk::Format format)</div><div class="ttdef"><b>Definition:</b> vku.hpp:316</div></div>
<div class="ttc" id="classvku_1_1_window_html_af965a82c0d4db0cd2ec6d69b1aa6295a"><div class="ttname"><a href="classvku_1_1_window.html#af965a82c0d4db0cd2ec6d69b1aa6295a">vku::Window::presentQueue</a></div><div class="ttdeci">const vk::Queue presentQueue() const </div><div class="ttdoc">Get the queue used to submit graphics jobs. </div><div class="ttdef"><b>Definition:</b> vku_framework.hpp:561</div></div>
<div class="ttc" id="classvku_1_1_window_html_ab316980670759352a77bcfea54f2018f"><div class="ttname"><a href="classvku_1_1_window.html#ab316980670759352a77bcfea54f2018f">vku::Window::ok</a></div><div class="ttdeci">bool ok() const </div><div class="ttdoc">Return true if this window was created sucessfully. </div><div class="ttdef"><b>Definition:</b> vku_framework.hpp:564</div></div>
<div class="ttc" id="classvku_1_1_framework_html_a4690bf772209a235299a896896f36a59"><div class="ttname"><a href="classvku_1_1_framework.html#a4690bf772209a235299a896896f36a59">vku::Framework::~Framework</a></div><div class="ttdeci">~Framework()</div><div class="ttdoc">Clean up the framework satisfying the Vulkan verification layers. </div><div class="ttdef"><b>Definition:</b> vku_framework.hpp:216</div></div>
<div class="ttc" id="classvku_1_1_window_html_a74ee0b88b51ee7b749a5f6efb597bc53"><div class="ttname"><a href="classvku_1_1_window.html#a74ee0b88b51ee7b749a5f6efb597bc53">vku::Window::draw</a></div><div class="ttdeci">void draw(const vk::Device &amp;device, const vk::Queue &amp;graphicsQueue, const std::function&lt; void(vk::CommandBuffer cb, int imageIndex, vk::RenderPassBeginInfo &amp;rpbi)&gt; &amp;dynamic=defaultRenderFunc)</div><div class="ttdef"><b>Definition:</b> vku_framework.hpp:494</div></div>
<div class="ttc" id="classvku_1_1_framework_html_a9a09279a046254b71d9575de369b585c"><div class="ttname"><a href="classvku_1_1_framework.html#a9a09279a046254b71d9575de369b585c">vku::Framework::graphicsQueueFamilyIndex</a></div><div class="ttdeci">uint32_t graphicsQueueFamilyIndex() const </div><div class="ttdoc">Get the family index for the graphics queues. </div><div class="ttdef"><b>Definition:</b> vku_framework.hpp:208</div></div>
<div class="ttc" id="classvku_1_1_framework_html_a39fa9cb694b8fe66d5f647635aaca77c"><div class="ttname"><a href="classvku_1_1_framework.html#a39fa9cb694b8fe66d5f647635aaca77c">vku::Framework::device</a></div><div class="ttdeci">const vk::Device device() const </div><div class="ttdoc">Get the Vulkan device. </div><div class="ttdef"><b>Definition:</b> vku_framework.hpp:190</div></div>
<div class="ttc" id="classvku_1_1_window_html_a7ced8a7cf030e3f30c8313a68a3d23d8"><div class="ttname"><a href="classvku_1_1_window.html#a7ced8a7cf030e3f30c8313a68a3d23d8">vku::Window::swapchain</a></div><div class="ttdeci">const vk::SwapchainKHR swapchain() const </div><div class="ttdoc">Return the swapchain object. </div><div class="ttdef"><b>Definition:</b> vku_framework.hpp:598</div></div>
<div class="ttc" id="classvku_1_1_window_html_ae522a36f60949617761371d494ce766f"><div class="ttname"><a href="classvku_1_1_window.html#ae522a36f60949617761371d494ce766f">vku::Window::swapchainImageFormat</a></div><div class="ttdeci">vk::Format swapchainImageFormat() const </div><div class="ttdoc">Return the format of the back buffer. </div><div class="ttdef"><b>Definition:</b> vku_framework.hpp:592</div></div>
<div class="ttc" id="classvku_1_1_window_html_a860291828c8e176979a0975358ee15ac"><div class="ttname"><a href="classvku_1_1_window.html#a860291828c8e176979a0975358ee15ac">vku::Window::commandCompleteSemaphore</a></div><div class="ttdeci">vk::Semaphore commandCompleteSemaphore() const </div><div class="ttdoc">Return the semaphore signalled when the command buffers are finished. </div><div class="ttdef"><b>Definition:</b> vku_framework.hpp:616</div></div>
<div class="ttc" id="classvku_1_1_framework_html"><div class="ttname"><a href="classvku_1_1_framework.html">vku::Framework</a></div><div class="ttdef"><b>Definition:</b> vku_framework.hpp:56</div></div>
<div class="ttc" id="classvku_1_1_window_html_a776998d6551da1e1b4462dfcc7437b85"><div class="ttname"><a href="classvku_1_1_window.html#a776998d6551da1e1b4462dfcc7437b85">vku::Window::imageAcquireSemaphore</a></div><div class="ttdeci">vk::Semaphore imageAcquireSemaphore() const </div><div class="ttdoc">Return the semaphore signalled when an image is acquired. </div><div class="ttdef"><b>Definition:</b> vku_framework.hpp:613</div></div>
<div class="ttc" id="classvku_1_1_window_html_ae5b21152f302ef2079f9dd600039a157"><div class="ttname"><a href="classvku_1_1_window.html#ae5b21152f302ef2079f9dd600039a157">vku::Window::framebuffers</a></div><div class="ttdeci">const std::vector&lt; vk::UniqueFramebuffer &gt; &amp; framebuffers() const </div><div class="ttdoc">Return the frame buffers used by this window. </div><div class="ttdef"><b>Definition:</b> vku_framework.hpp:570</div></div>
<div class="ttc" id="classvku_1_1_window_html_a38e18f5134cee0a1aec52d4e05ba01cb"><div class="ttname"><a href="classvku_1_1_window.html#a38e18f5134cee0a1aec52d4e05ba01cb">vku::Window::presentQueueFamily</a></div><div class="ttdeci">uint32_t presentQueueFamily() const </div><div class="ttdoc">Return the queue family index used to present the surface to the display. </div><div class="ttdef"><b>Definition:</b> vku_framework.hpp:558</div></div>
<div class="ttc" id="classvku_1_1_window_html_ae72647dc506298b8aa36388b6eddd918"><div class="ttname"><a href="classvku_1_1_window.html#ae72647dc506298b8aa36388b6eddd918">vku::Window::numImageIndices</a></div><div class="ttdeci">int numImageIndices() const </div><div class="ttdoc">Return the number of swap chain images. </div><div class="ttdef"><b>Definition:</b> vku_framework.hpp:622</div></div>
<div class="ttc" id="classvku_1_1_window_html_a335f8cc62a55d17d970b1a910790e350"><div class="ttname"><a href="classvku_1_1_window.html#a335f8cc62a55d17d970b1a910790e350">vku::Window::commandPool</a></div><div class="ttdeci">vk::CommandPool commandPool() const </div><div class="ttdoc">Return a defult command Pool to use to create new command buffers. </div><div class="ttdef"><b>Definition:</b> vku_framework.hpp:619</div></div>
<div class="ttc" id="classvku_1_1_window_html_a918e978d75d5cc6a1409a8f8e60d2735"><div class="ttname"><a href="classvku_1_1_window.html#a918e978d75d5cc6a1409a8f8e60d2735">vku::Window::commandBufferFences</a></div><div class="ttdeci">const std::vector&lt; vk::Fence &gt; &amp; commandBufferFences() const </div><div class="ttdoc">Return the fences used to control the static buffers. </div><div class="ttdef"><b>Definition:</b> vku_framework.hpp:610</div></div>
<div class="ttc" id="classvku_1_1_depth_stencil_image_html"><div class="ttname"><a href="classvku_1_1_depth_stencil_image.html">vku::DepthStencilImage</a></div><div class="ttdoc">An image to use as a depth buffer on a renderpass. </div><div class="ttdef"><b>Definition:</b> vku.hpp:1460</div></div>
<div class="ttc" id="namespacevku_html"><div class="ttname"><a href="namespacevku.html">vku</a></div><div class="ttdoc">Vookoo high level C++ Vulkan interface. </div><div class="ttdef"><b>Definition:</b> vku.hpp:34</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
